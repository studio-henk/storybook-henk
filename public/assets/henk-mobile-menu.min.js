export const mobileMenu={name:"mobile-menu",headerAttr:"[data-js-mobile-menu]",openButtonAttr:"[data-js-mobile-menu-open]",closeButtonAttr:"[data-js-mobile-menu-close]",get header(){return document.querySelector(this.headerAttr)},get headerInner(){return document.querySelector("header.henk-header > .henk-header__inner")},get hamburgerButtonSelector(){return document.querySelector(this.openButtonAttr)},get closeButtonSelector(){return document.querySelector(this.closeButtonAttr)},removeTrap:null,escListener:null,init(){console.log("Mobile menu init");const e=document.querySelector("header.henk-header");if(!e)return null;e.dataset.state="closed",this.addHamburgerButton(),this.addCloseButton()},addHamburgerButton(){const e=document.createElement("button");e.type="button",e.className="henk-button henk-button--ghost henk-header__button--open-menu",e.setAttribute("aria-label","Open menu"),e.setAttribute("aria-expanded","false"),e.dataset.jsMobileMenuOpen="",e.innerHTML='\n<i class="henk-icon icon--only">\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n    stroke="currentColor"\n    stroke-width="1"\n  >\n    <line x1="0" y1="0.5" x2="24" y2="0.5" />\n    <line x1="0" y1="12" x2="24" y2="12" />\n    <line x1="0" y1="23.5" x2="24" y2="23.5" />\n  </svg>\n</i>\n<span class="visually-hidden">Menu</span>\n    ',this.headerInner&&(this.headerInner.insertAdjacentElement("afterbegin",e),e.addEventListener("click",mobileMenu.toggleMenu))},addCloseButton(){const e=document.createElement("button");e.type="button",e.className="henk-button henk-button--ghost henk-button--small henk-header__button--close-menu",e.setAttribute("aria-label","Close menu"),e.dataset.jsMobileMenuClose="",e.innerHTML='\n      <i class="henk-icon">\n        <svg\n          width="24"\n          height="24"\n          viewBox="0 0 24 24"\n          fill="none"\n          xmlns="http://www.w3.org/2000/svg"\n        >\n          <path\n            d="M23.5 0.5L0.5 23.5M0.5 0.5L23.5 23.5"\n            stroke="currentcolor"\n            stroke-linecap="round"\n            stroke-linejoin="round"\n          ></path>\n        </svg>\n      </i>\n      CLOSE\n    ',e.style.display="none",this.headerInner&&(this.headerInner.insertAdjacentElement("afterbegin",e),e.addEventListener("click",mobileMenu.toggleMenu))},trapMenuTabbing(){const e=this.header;if(!e)return null;if(!e.querySelector("details[name='main-nav']"))return null;const t=this.closeButtonSelector,n=e.querySelector("[data-js-cart], .henk-cart, [aria-label='Cart'], a[href*='cart']")||t;if(!t||!n)return null;const o=e=>{"Tab"===e.key&&(e.shiftKey||document.activeElement!==n?e.shiftKey&&document.activeElement===t&&(e.preventDefault(),n.focus()):(e.preventDefault(),t.focus()))};return e.addEventListener("keydown",o),()=>{e.removeEventListener("keydown",o)}},addEscListener(){this.escListener||(this.escListener=e=>{"Escape"===e.key&&this.toggleMenu()},document.documentElement.addEventListener("keydown",this.escListener))},removeEscListener(){this.escListener&&(document.documentElement.removeEventListener("keydown",this.escListener),this.escListener=null)},toggleMenu(){var e;if(mobileMenu.header)if("open"===mobileMenu.header.dataset.state)mobileMenu.header.dataset.state="closed",mobileMenu.hamburgerButtonSelector.setAttribute("aria-expanded","false"),mobileMenu.closeButtonSelector.style.display="none",mobileMenu.removeEscListener(),null===(e=mobileMenu.removeTrap)||void 0===e||e.call(mobileMenu),mobileMenu.removeTrap=null,mobileMenu.closeAllSubs();else{if(!mobileMenu.header)return;if(!mobileMenu.hamburgerButtonSelector)return;if(!mobileMenu.closeButtonSelector)return;mobileMenu.header.dataset.state="open",mobileMenu.hamburgerButtonSelector.setAttribute("aria-expanded","true"),mobileMenu.closeButtonSelector.style.display="flex",mobileMenu.closeButtonSelector.focus(),mobileMenu.addEscListener(),mobileMenu.removeTrap=mobileMenu.trapMenuTabbing();const e=mobileMenu.header.querySelector("details[name='main-nav']");e&&(e.open=!0)}},closeAllSubs(){mobileMenu.header&&mobileMenu.header.querySelectorAll("details[name='main-nav'][open]").forEach(e=>{e.open=!1})},destroy(){var e,t,n,o,r;this.header&&(this.header.dataset.state="closed"),null===(e=this.removeTrap)||void 0===e||e.call(this),this.removeTrap=null,this.removeEscListener(),null===(t=this.hamburgerButtonSelector)||void 0===t||t.removeEventListener("click",this.toggleMenu),null===(n=this.hamburgerButtonSelector)||void 0===n||n.remove(),null===(o=this.closeButtonSelector)||void 0===o||o.removeEventListener("click",this.toggleMenu),null===(r=this.closeButtonSelector)||void 0===r||r.remove(),this.closeAllSubs(),console.log("Mobile menu destroyed")},setupMatchMedia(){const e=window.matchMedia("(max-width: 767px)");let t=!1;const n=e=>{e.matches&&!t?(this.init(),t=!0):!e.matches&&t&&(this.destroy(),t=!1)};n(e),e.addEventListener("change",n)}};